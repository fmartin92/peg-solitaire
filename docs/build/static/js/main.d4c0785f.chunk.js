(this["webpackJsonppeg-solitaire"]=this["webpackJsonppeg-solitaire"]||[]).push([[0],{26:function(e,t,n){e.exports=n(41)},31:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(23),o=n.n(i),u=(n(31),n(32),n(3)),c=n(4),s=n(11),l=n(10),m=n(24),h=n(1),d=n(5),f=(n(33),n(15)),v=n(9),g={height:{name:"Height",min:2,max:6,default:2}},p={pow:{name:"Power",min:1,max:40,default:25}},b={name:"Random choice",params:{},play:function(e){return E(e.children)}},y={name:"Maximize descendants",params:Object(v.a)({},g),play:function(e,t){return E(k(e.children,(function(e){return e.getSubtreeSize(t.height)})))}};function E(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 1},n=e.map(t),a=n.reduce((function(e,t){return e+t}),0),r=Math.random()*a,i=0,o=-1;i<=r;)i+=n[++o];return e[o]}function k(e,t){var n=e.map(t),a=Math.max.apply(Math,Object(f.a)(n));return e.filter((function(e,t){return n[t]===a}))}var _=[b,y,{name:"Randomized maximize descendants",params:Object(v.a)(Object(v.a)({},g),p),play:function(e,t){return E(e.children,(function(e){return Math.pow(e.getSubtreeSize(t.height),t.pow)}))}},{name:"Few connected components",params:Object(v.a)(Object(v.a)({},g),p),play:function(e,t){var n,a;return E((n=e.children,a=function(e){return e.game.getNumConnectedComponents()},k(n,(function(e){return-a(e)}))),(function(e){return Math.pow(e.getSubtreeSize(t.height),t.pow)}))}}],S=y;function O(e){var t={};return Object.entries(e.params).forEach((function(e){var n=Object(d.a)(e,2),a=n[0],r=n[1];return t[a]=r.default})),t}n(34);var j="up",w="right",N="down",X="left",C=["  XXX  ","  XXX  ","XXXXXXX","XXX.XXX","XXXXXXX","  XXX  ","  XXX  "].map((function(e){return e.split("")})),M=function(e){return e.map((function(e){return e.map((function(e){return e}))}))},D=function(){function e(t){Object(u.a)(this,e),this._board=t||M(C)}return Object(c.a)(e,[{key:"_computeDstSquare",value:function(e,t,n){var a=e,r=t;switch(n){case j:a--;break;case w:r++;break;case N:a++;break;case X:r--;break;default:throw new Error("".concat(n," is not a valid direction"))}return[a,r]}},{key:"_computeIntermediateDstSquare",value:function(e,t,n,a){return[(e+n)/2,(t+a)/2]}},{key:"_computeJumpDstSquare",value:function(e,t,n){var a=this._computeDstSquare(e,t,n),r=Object(d.a)(a,2),i=r[0],o=r[1];return this._computeDstSquare(i,o,n)}},{key:"moveTo",value:function(t,n,a,r){if(!this._isValidMove(t,n,a,r))throw new Error("Invalid move");var i=M(this._board),o=function(e,t,n){return i[e][t]=n},u=this._computeIntermediateDstSquare(t,n,a,r),c=Object(d.a)(u,2),s=c[0],l=c[1];return o(t,n,"."),o(s,l,"."),o(a,r,"X"),new e(i)}},{key:"_isValidMove",value:function(e,t,n,a){var r=this._computeIntermediateDstSquare(e,t,n,a),i=Object(d.a)(r,2),o=i[0],u=i[1];return!!this._isWithinBounds(e,t)&&(!!this._isWithinBounds(n,a)&&("X"===this.get(e,t)&&("X"===this.get(o,u)&&"."===this.get(n,a))))}},{key:"getValidMovesAt",value:function(e,t){var n=this,a=[];return[j,w,N,X].forEach((function(r){var i=n._computeJumpDstSquare(e,t,r),o=Object(d.a)(i,2),u=o[0],c=o[1];n._isValidMove(e,t,u,c)&&a.push([u,c])})),a}},{key:"getPossibleMoves",value:function(){for(var t=this,n=[],a=function(a){for(var r=function(r){if("X"!==t.get(a,r))return"continue";[j,w,N,X].forEach((function(i){var o=t._computeDstSquare(a,r,i),u=Object(d.a)(o,2),c=u[0],s=u[1],l=t._computeDstSquare(c,s,i),m=Object(d.a)(l,2),h=m[0],f=m[1];if(t._isWithinBounds(h,f)&&"X"===t.get(c,s)&&"."===t.get(h,f)){var v=M(t._board);v[a][r]=".",v[c][s]=".",v[h][f]="X",n.push(new e(v))}}))},i=0;i<7;i++)r(i)},r=0;r<7;r++)a(r);return n}},{key:"isOver",value:function(){return 0===this.getPossibleMoves().length}},{key:"get",value:function(e,t){return this._board[e][t]}},{key:"_isWithinBounds",value:function(e,t){return e>=0&&e<7&&t>=0&&t<7}},{key:"_isPeg",value:function(e,t){return this._isWithinBounds(e,t)&&"X"===this.get(e,t)}},{key:"_getNeighborPegs",value:function(e,t){var n=this,a=[],r=function(e,t){n._isPeg(e,t)&&a.push([e,t])};return r(e,t-1),r(e+1,t),r(e,t+1),r(e-1,t),a}},{key:"_bfs",value:function(e,t,n){for(var a=[[e,t]];0!==a.length;){var r=a.shift(),i=Object(d.a)(r,2),o=i[0],u=i[1],c="".concat(o,",").concat(u);n.has(c)||(n.add(c),this._getNeighborPegs(o,u).filter((function(e){return!n.has("".concat(e[0],",").concat(e[1]))})).forEach((function(e){return a.push(e)})))}}},{key:"getNumConnectedComponents",value:function(){for(var e=0,t=new Set,n=0;n<7;n++)for(var a=0;a<7;a++)this._isPeg(n,a)&&!t.has("".concat(n,",").concat(a))&&(e++,this._bfs(n,a,t));return e}},{key:"numPegsLeft",value:function(){return this.toString().split("").filter((function(e){return"X"===e})).length}},{key:"toString",value:function(){return this._board.map((function(e){return e.join("")})).join("\n")}},{key:"equals",value:function(e){return 0===this.toString().localeCompare(e.toString())}}]),e}(),P={candidateTargets:[],moveSrcRow:-1,moveSrcCol:-1},T=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state=P,a}return Object(c.a)(n,[{key:"render",value:function(){for(var e=this,t=[],n=0;n<7;n++)for(var a=0;a<7;a++)t.push([n,a]);return r.a.createElement("div",{className:"board"},t.map((function(t){var n=Object(d.a)(t,2),a=n[0],i=n[1],o=[];switch(e.props.game.get(a,i)){case" ":o.push("invalid-square");break;case".":o.push("empty-square");break;case"X":o.push("peg-square");break;default:throw new Error("invalid square at ".concat(a,", ").concat(i,': "').concat(e.props.game.get(a,i),'"'))}return e.isCandidateTarget(a,i)&&o.push("candidate-target"),a===e.state.moveSrcRow&&i===e.state.moveSrcCol&&o.push("selected"),e.isPegDraggable(a,i)&&o.push("draggable"),r.a.createElement("div",{key:"".concat(a,",").concat(i),className:"cell ".concat(o.join(" ")),onDragEnd:function(){return e.onPegDragEnd()},onDragOver:function(e){return e.preventDefault()},onDrop:function(){return e.onSquareDrop(a,i)}},r.a.createElement("div",{className:"peg",draggable:e.isPegDraggable(a,i),onMouseEnter:function(){return e.onMouseEnter(a,i)},onMouseLeave:function(){return e.onMouseLeave()},onDragStart:function(){return e.onPegDragStart(a,i)}}))})))}},{key:"onMouseEnter",value:function(e,t){this.setState({candidateTargets:this.props.game.getValidMovesAt(e,t)})}},{key:"onMouseLeave",value:function(e){this.setState(P)}},{key:"onPegDragStart",value:function(e,t){this.isPegDraggable(e,t)&&this.setState({candidateTargets:this.props.game.getValidMovesAt(e,t),moveSrcRow:e,moveSrcCol:t})}},{key:"onPegDragEnd",value:function(){this.dragDidStop()}},{key:"onSquareDrop",value:function(e,t){if(this.isMoving()&&this.isCandidateTarget(e,t)){var n=this.props.game.moveTo(this.state.moveSrcRow,this.state.moveSrcCol,e,t);this.props.gameChangedCb(n)}this.dragDidStop()}},{key:"dragDidStop",value:function(){this.setState(P)}},{key:"isPegDraggable",value:function(e,t){return this.props.game.getValidMovesAt(e,t).length>0}},{key:"isMoving",value:function(){return this.state.moveSrcRow>=0&&this.state.moveSrcCol>=0}},{key:"isCandidateTarget",value:function(e,t){return!!this.state.candidateTargets.find((function(n){return n[0]===e&&n[1]===t}))}}]),n}(r.a.Component),q=n(17),R=(n(35),function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("select",{value:this.props.value,onChange:function(t){return e.props.onAlgorithmChange(_.find((function(e){return e.name===t.target.value})))}},_.map((function(e){return r.a.createElement("option",{key:e.name,value:e.name},e.name)})))}}]),n}(r.a.Component)),A=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(u.a)(this,e),this._game=t,this._parent=n,this._children=null}return Object(c.a)(e,[{key:"clearParent",value:function(){this._parent=null}},{key:"getSubtreeSize",value:function(e){if(e<1)throw new Error("maxHeight should be at least 1, got ".concat(e," instead"));return 1===e?1:this.children.map((function(t){return t.getSubtreeSize(e-1)})).reduce((function(e,t){return e+t}),1)}},{key:"findChildByGame",value:function(e){return this.children.find((function(t){return t.game.equals(e)}))}},{key:"parent",get:function(){return this._parent}},{key:"game",get:function(){return this._game}},{key:"children",get:function(){var t=this;return null===this._children&&(this._children=this.game.getPossibleMoves().map((function(n){return new e(n,t)}))),this._children}}]),e}(),x=function(){function e(t,n){Object(u.a)(this,e),this._algorithm=t,this._params=n||O(t)}return Object(c.a)(e,[{key:"run",value:function(){for(var e=new D,t=new A(e);!t.game.isOver();)(t=this._algorithm.play(t,this._params)).clearParent();return t.game}},{key:"runMany",value:function(e){this._scores=[],this._times=[];for(var t=0;t<e;t++){var n=performance.now(),a=this.run(),r=performance.now();this._scores.push(a.numPegsLeft()),this._times.push(r-n)}}},{key:"scores",get:function(){return this._scores||[]}},{key:"times",get:function(){return this._times||[]}}]),e}(),I=function(e){return parseInt(100*e)/100},B=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state=Object(v.a)(Object(v.a)({},a.makeDefaultAlgorithmState(S)),{},{numIterations:10,scores:[],times:[]}),a}return Object(c.a)(n,[{key:"makeDefaultAlgorithmState",value:function(e){return{algorithm:e,algorithmParams:O(e)}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"debug-tools"},r.a.createElement("div",{className:"inputs"},r.a.createElement("p",null,"Algorithm:",r.a.createElement(R,{value:this.state.algorithm.name,onAlgorithmChange:function(t){return e.setState(e.makeDefaultAlgorithmState(t))}})),Object.entries(this.state.algorithm.params).map((function(t){var n=Object(d.a)(t,2),a=n[0],i=n[1];return r.a.createElement("p",{key:a},i.name,":",r.a.createElement("input",{type:"number",min:i.min,max:i.max,value:e.state.algorithmParams[a],onChange:function(t){return e.setState({algorithmParams:Object(v.a)(Object(v.a)({},e.state.algorithmParams),{},Object(q.a)({},a,+t.target.value))})}}))})),r.a.createElement("p",null,"Number of iterations:",r.a.createElement("input",{type:"number",min:"1",value:this.state.numIterations,onChange:function(t){return e.setState({numIterations:t.target.value})}})),r.a.createElement("button",{onClick:function(){return e.run()}},"Run")),r.a.createElement("div",{className:"output"},this.state.scores.length>0?this.nonEmptyOutput():this.emptyOutput()))}},{key:"emptyOutput",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,"Selected algorithm: ",this.state.algorithm.name),r.a.createElement("p",null,"Number of iterations: ",this.state.numIterations))}},{key:"nonEmptyOutput",value:function(){var e=this.computeStats(this.state.scores),t=this.computeStats(this.state.times);return r.a.createElement("div",{className:"non-empty-output"},this.statsTable(t,"Time stats"),this.statsTable(e,"Scores stats"),r.a.createElement("table",null,r.a.createElement("caption",null,"Scores histogram"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Score"),r.a.createElement("th",null,"Frequency"),r.a.createElement("th",null,"Bar plot"))),r.a.createElement("tbody",null,Array.from(e.histogram.entries()).map((function(e){return r.a.createElement("tr",{key:e[0]},r.a.createElement("td",null,e[0]),r.a.createElement("td",null,e[1]),r.a.createElement("td",{className:"histogram-bar"},"*".repeat(e[1])))})))))}},{key:"statsTable",value:function(e,t){return r.a.createElement("table",null,r.a.createElement("caption",null,t),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Statistic"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Min"),r.a.createElement("td",null,I(e.min))),r.a.createElement("tr",null,r.a.createElement("td",null,"Max"),r.a.createElement("td",null,I(e.max))),r.a.createElement("tr",null,r.a.createElement("td",null,"Mean"),r.a.createElement("td",null,I(e.mean))),r.a.createElement("tr",null,r.a.createElement("td",null,"Std. dev."),r.a.createElement("td",null,I(e.stdDev)))))}},{key:"run",value:function(){var e=new x(this.state.algorithm,this.state.algorithmParams);e.runMany(this.state.numIterations),this.setState({scores:e.scores,times:e.times})}},{key:"computeStats",value:function(e){var t=e.reduce((function(e,t){return e+t}),0)/e.length,n=Math.sqrt(e.reduce((function(e,n){return e+Math.pow(n-t,2)}),0)/e.length);return{min:Math.min.apply(Math,Object(f.a)(e)),max:Math.max.apply(Math,Object(f.a)(e)),mean:t,stdDev:n,histogram:this.computeHistogram(e)}}},{key:"computeHistogram",value:function(e){e.sort((function(e,t){return e-t}));var t=new Map;return e.forEach((function(e){t.has(e)||t.set(e,0),t.set(e,t.get(e)+1)})),t}}]),n}(r.a.Component),U=function(){function e(){Object(u.a)(this,e),this.restart()}return Object(c.a)(e,[{key:"restart",value:function(){this._rootNode=new A(new D),this._currentNode=this._rootNode,this._mostRecentNode=this._rootNode}},{key:"move",value:function(e){var t;if(e instanceof D){if(!(t=this._currentNode.findChildByGame(e)))throw new Error("Tried to move to an unreachable position")}else{if(!(e instanceof A))throw new Error("move() accepts Game or DecisionNode objects only.");if(t=e,!this.currentNode.children.includes(t))throw new Error("Tried to move to an unreachable position")}this._currentNode=t,this._mostRecentNode=t}},{key:"canUndo",value:function(){return this._currentNode!==this._rootNode}},{key:"canRedo",value:function(){return this._currentNode!==this._mostRecentNode}},{key:"undo",value:function(){if(!this.canUndo())throw new Error("Already at earliest move");this._currentNode=this._currentNode.parent}},{key:"redo",value:function(){if(!this.canRedo())throw new Error("Already at most recent move");for(var e=this._mostRecentNode;e.parent!==this._currentNode;)e=e.parent;this._currentNode=e}},{key:"currentNode",get:function(){return this._currentNode}},{key:"game",get:function(){return this._currentNode.game}}]),e}(),z=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).state={algorithm:S,decisionTree:new U},a}return Object(c.a)(n,[{key:"newMovement",value:function(){var e={};Object.entries(this.state.algorithm.params).forEach((function(t){var n=Object(d.a)(t,2),a=n[0],r=n[1];return e[a]=r.default})),this.state.decisionTree.move(this.state.algorithm.play(this.state.decisionTree.currentNode,{height:2,pow:30}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"app container"},r.a.createElement("div",{className:"board-and-controls"},r.a.createElement(T,{game:this.state.decisionTree.game,gameChangedCb:function(t){e.onGameChange(t),e.forceUpdate()}}),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{onClick:function(){e.newMovement(),e.forceUpdate()},disabled:this.state.decisionTree.game.isOver()},"New movement"),r.a.createElement(R,{value:this.state.algorithm.name,onAlgorithmChange:function(t){return e.onAlgorithmChange(t)}}),r.a.createElement("button",{onClick:function(){e.state.decisionTree.undo(),e.forceUpdate()},disabled:!this.state.decisionTree.canUndo()},"Undo"),r.a.createElement("button",{onClick:function(){e.state.decisionTree.redo(),e.forceUpdate()},disabled:!this.state.decisionTree.canRedo()},"Redo"),r.a.createElement("button",{onClick:function(){e.state.decisionTree.restart(),e.forceUpdate()}},"Restart"))))}},{key:"onGameChange",value:function(e){this.state.decisionTree.move(e)}},{key:"onAlgorithmChange",value:function(e){this.setState({algorithm:e})}}]),n}(r.a.Component),V=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement("span",{className:"navbar-brand"},"Peg solitaire")),r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:"/"},r.a.createElement(z,null)),r.a.createElement(h.a,{path:"/about"},r.a.createElement("h1",null,"holis")),r.a.createElement(h.a,{path:"/dev"},r.a.createElement(B,null))))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.d4c0785f.chunk.js.map